<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE en-note SYSTEM "http://xml.evernote.com/pub/enml2.dtd">
<en-note><div># Written by KFH: <a href="mailto:karshi.hasanov@utoronto.ca">karshi.hasanov@utoronto.ca</a></div><div># Date: August 2, 2017</div><div># Last Modified: August 2, 2017</div><div># Description: This HOWTO will describe how to setup a Git repository on FreeBSD 11.0</div><div><br/></div><div><span style="font-weight: bold; font-size: 24px;">Step 1: Installing the Git</span></div><div><span style="color: rgb(169, 169, 169);"># Always update the ports first</span></div><div>    =&gt; <span style="color: rgb(255, 38, 0);">sudo</span> <span style="font-weight: bold;">/usr/sbin/</span><span style="font-weight: bold;">portsnap</span> <span style="font-style: italic;">fetch</span></div><div><span style="color: rgb(169, 169, 169);"># Install the Git ( you can use the “pkg add “ command to install if you want)</span></div><div>    =&gt;<span style="font-weight: bold;"> cd</span> <span style="color: rgb(148, 17, 0);">/usr/ports/devel/git</span></div><div>    =&gt; <span style="color: rgb(255, 38, 0);">sudo</span><span style="font-weight: bold;"> make install clean</span></div><div><br/></div><div><span style="font-weight: bold; font-size: 24px;">Step 2: Creating the dedicated user and group for Git repos</span></div><div>    =&gt;<span style="font-weight: bold;"> </span><span style="color: rgb(255, 38, 0);">sudo</span><span style="font-weight: bold;"> pw</span> <span style="font-weight: bold;">groupadd</span> <span style="font-weight: bold;">-n</span> <span style="color: rgb(255, 64, 255);">git</span> <span style="font-weight: bold;">-g</span>  6891  <span style="color: rgb(146, 146, 146);"># Add the  group name “git” with GUID = 6891</span></div><div>    =&gt;<span style="color: rgb(255, 38, 0);"> sudo</span> <span style="font-weight: bold;">pw</span> <span style="font-weight: bold;">useradd</span> <span style="font-weight: bold;">-n</span> <span style="color: rgb(0, 150, 255);">git </span><span style="font-weight: bold;">-u</span> 6891 <span style="font-weight: bold;">-g</span> <span style="color: rgb(255, 64, 255);">git</span> <span style="font-weight: bold;">-d</span> <span style="color: rgb(148, 17, 0);">/home/git</span> <span style="font-weight: bold;">-s</span> <span style="color: rgb(148, 17, 0);">/usr/local/libexec/git-core/git-shell</span><span style="font-weight: bold;"> -h -</span> </div><div>    <span style="color: rgb(146, 146, 146);"># Add the user name “git” with UID = 6891, HOME=/home/git, “s” allowed shell command.</span></div><div><span style="color: rgb(146, 146, 146);">    # Make sure that the directory exist and the owned by the “git user.</span></div><div><span style="color: rgb(146, 146, 146);">    </span>=&gt; <span style="color: rgb(255, 38, 0);">sudo </span><span style="font-weight: bold;">mkdir</span> <span style="color: rgb(148, 17, 0);">/home/git </span></div><div>    =&gt;<span style="color: rgb(255, 38, 0);"> sudo</span><span style="font-weight: bold;"> chown -R</span> <span style="color: rgb(4, 51, 255);">git</span>:<span style="color: rgb(255, 64, 255);">git</span> <span style="color: rgb(148, 17, 0);">/home/git</span></div><div><span style="color: rgb(148, 17, 0);">    </span>=&gt;<span style="color: rgb(148, 17, 0);"> </span><span style="color: rgb(255, 38, 0);">sudo</span><span style="color: rgb(148, 17, 0); font-weight: bold;"> </span><span style="font-weight: bold;">chmod 775</span><span style="color: rgb(148, 17, 0);"> </span><span style="color: rgb(148, 17, 0);">/home/git</span></div><div><br/></div><div>    <span style="color: rgb(145, 145, 145);"># We want to keep the repos in the /home/git/base folder:</span></div><div>    =&gt; <span style="color: rgb(255, 38, 0);">sudo</span> <span style="font-weight: bold;">mkdir </span><span style="color: rgb(148, 17, 0);">/home/git/base</span></div><div>    =&gt; <span style="color: rgb(255, 38, 0);">sudo</span> <span style="font-weight: bold;">chmod 775</span> <span style="color: rgb(148, 17, 0);">/home/git/base</span></div><div><br/></div><div><span style="color: rgb(148, 17, 0);">    </span><span style="color: rgb(145, 145, 145);"># Add a user to the git group</span></div><div>    =&gt; <span style="color: rgb(255, 38, 0);">sudo</span> <span style="font-weight: bold;">vi</span> <span style="color: rgb(148, 17, 0);">/etc/group </span></div><div>        …</div><div>       <span style="color: rgb(255, 64, 255);"> git</span>:*:6891:<span style="font-weight: bold;">khasanov</span></div><div><br/></div><div><span style="font-weight: bold; font-size: 24px;">Step 3: Setting Up the SSH Access to commit</span></div><div>    =&gt;<span style="color: rgb(255, 38, 0);"> sudo</span> <span style="font-weight: bold;">mkdir </span><span style="font-weight: bold; color: rgb(148, 17, 0);">/</span><span style="color: rgb(148, 17, 0);">home/git/.ssh</span></div><div>    =&gt; <span style="color: rgb(255, 38, 0);">sudo</span> <span style="font-weight: bold;">chmod 700</span> <span style="color: rgb(148, 17, 0);">/home/git/.ssh</span></div><div>    =&gt; <span style="color: rgb(255, 38, 0);">sudo </span><span style="font-weight: bold;">touch</span><span style="color: rgb(148, 17, 0);"> /home/git/.ssh/</span><span style="color: rgb(0, 144, 81);">authorized_keys</span></div><div>    =&gt; <span style="color: rgb(255, 38, 0);">sudo</span> <span style="font-weight: bold;">chmod 600</span> <span style="color: rgb(148, 17, 0);">/home/git/.ssh/</span><span style="color: rgb(0, 144, 81);">authorized_keys</span></div><div>    <span style="color: rgb(146, 146, 146);">#</span><span style="color: rgb(255, 38, 0);"> Important:</span><span style="color: rgb(146, 146, 146);"> You need to add the public keys of those who are in the git group </span></div><div><span style="color: rgb(146, 146, 146);">    # to the “</span><span style="color: rgb(0, 144, 81);">authorized_keys</span><span style="color: rgb(146, 146, 146);">” file line by line.</span></div><div><span style="color: rgb(146, 146, 146);">    </span>=&gt;<span style="color: rgb(255, 38, 0);"> sudo</span> <span style="font-weight: bold;">chown -R</span> git:git <span style="color: rgb(148, 17, 0);">/home/git/.ssh/</span></div><div><br/></div><div>    # How To generate a public and private RSA keys with 2048 size:</div><div>    [khasanov@freebsd /~]$ ssh-keygen -t rsa -b 2048</div><div>    Generating public/private rsa key pair.</div><div>    Enter file in which to save the key (/home/khasanov/.ssh/id_rsa): &lt;Enter&gt;</div><div>    Enter passphrase (empty for no passphrase): &lt;Enter&gt;</div><div>    Enter same passphrase again: &lt;Enter&gt;</div><div>    ( this will create “id_rsa” and “id_ rsa.pub” keys under /home/khasanov/.ssh )</div><div><br/></div><div>    # How to copy the public key to the Git’s “authorized” file:</div><div>    # You need to be the root user to issue the command below</div><div>    =&gt; su   ( you need to login as a root in order this to work !)</div><div><span>    root&gt; cat /home/khasanov/.ssh/id_rsa.pub &gt;&gt; /home/git/.ssh/authorized_keys</span></div><div><span> <span>    # If you are using the remote PC, copy the public key to the server first!</span></span><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div></en-note>
