<!DOCTYPE en-note SYSTEM "http://xml.evernote.com/pub/enml2.dtd"><en-note><div><span style="font-weight: bold; font-size: 24px;">Modifying Nginx Server Config File </span></div><div><span style="color: rgb(146, 146, 146);">#: Written by KFH: </span><a href="mailto:karshi.hasanov@utoronto.ca" style="color: rgb(146, 146, 146);">karshi.hasanov@utoronto.ca</a></div><div><span style="color: rgb(146, 146, 146);">#: Date: Dec. 8, 2017</span></div><div><span style="color: rgb(146, 146, 146);">#: Description: An example of running Pyramid Applications under Nginx</span></div><div><span style="color: rgb(146, 146, 146);">#: Last Modified: ...</span></div><div><br /></div><div><span style="color: rgb(146, 146, 146);"># Edit the "/usr/local/etc/nginx/nginx.conf” file :</span></div><div><span style="color: rgb(146, 146, 146);"># Modified or Added lines are shown only!</span></div><div><hr /></div><div><span style="font-weight: bold;">user</span> <span style="color: rgb(255, 64, 255);">www</span></div><div><span style="font-weight: bold;">worker_processes</span> <span style="color: rgb(255, 64, 255);">4</span>;</div><div><span style="font-weight: bold;">…</span></div><div><span style="font-weight: bold;">http</span> {</div><div>   ...</div><div>    tcp_nodelay    on;</div><div>    types_hash_max_size 2048;</div><div>    gzip  on;</div><div>    gzip_disable "msie6";</div><div><br /></div><div>    <span style="color: rgb(146, 146, 146);"># KFH: Upstream for Pyramid’s pserve</span></div><div>    <span style="color: rgb(79, 143, 0); font-weight: bold;">upstream</span> <span style="color: rgb(255, 64, 255);">myapp-site</span> {</div><div>    <span style="color: rgb(79, 143, 0); font-weight: bold;">server</span> <span style="font-weight: bold;">127.0.0.1:</span><span style="color: rgb(0, 150, 255); font-weight: bold;">8585</span>;</div><div>    }</div><div><br /></div><div>  <span style="font-weight: bold;"> </span><span style="color: rgb(4, 51, 255); font-weight: bold;"> server</span> {</div><div>       <span style="font-weight: bold;"> listen</span>       <span style="color: rgb(4, 51, 255);">192.168.100.150</span>:<span style="color: rgb(0, 145, 147);">8888</span>;</div><div>       <span style="font-weight: bold;"> server_name</span> <span style="color: rgb(148, 17, 0);"> freebsd.karshi.ca;</span></div><div><br /></div><div>      <span style="font-weight: bold;">  location</span><span style="color: rgb(255, 47, 146); font-weight: bold;"> / </span>{</div><div>            <span style="color: rgb(146, 146, 146);"># KFH =&gt; root   /usr/local/</span><a href="http://www/nginx" style="color: rgb(146, 146, 146);">www/nginx</a><span style="color: rgb(146, 146, 146);">;</span></div><div><span style="color: rgb(146, 146, 146);">            # KFH =&gt;index  index.html index.htm;</span></div><div><span style="color: rgb(146, 146, 146);">            # KFH Added:</span></div><div>           <span style="color: rgb(148, 55, 255);"> proxy_set_header</span>        <span style="color: rgb(79, 143, 0);">Host $http_host;</span></div><div>           <span style="color: rgb(148, 55, 255);"> proxy_set_header  </span>      <span style="color: rgb(79, 143, 0);">X-Real-IP $remote_addr;</span></div><div>           <span style="color: rgb(148, 55, 255);"> proxy_set_header</span>       <span style="color: rgb(79, 143, 0);"> X-Forwarded-For $proxy_add_x_forwarded_for;</span></div><div>           <span style="color: rgb(148, 55, 255);"> proxy_set_header   </span>   <span style="color: rgb(79, 143, 0);">  X-Forwarded-Proto $scheme;</span></div><div><br /></div><div>          <span style="color: rgb(148, 55, 255);">  client_max_body_size </span>   <span style="font-weight: bold;">10m</span>;</div><div>           <span style="color: rgb(148, 55, 255);"> client_body_buffer_size</span> <span style="font-weight: bold;">128k</span>;</div><div>            <span style="color: rgb(148, 55, 255);">proxy_connect_timeout </span> <span style="font-weight: bold;"> 60s</span>;</div><div>           <span style="color: rgb(148, 55, 255);"> proxy_send_timeout </span>    <span style="font-weight: bold;"> 90s</span>;</div><div>           <span style="color: rgb(148, 55, 255);"> proxy_read_timeout   </span>  <span style="font-weight: bold;"> 90s</span>;</div><div>           <span style="color: rgb(148, 55, 255);"> proxy_buffering  </span>       <span style="color: rgb(255, 47, 146);">off</span>;</div><div>            <span style="color: rgb(148, 55, 255);">proxy_temp_file_write_size</span><span style="font-weight: bold;"> 64k</span>;</div><div>            <span style="color: rgb(148, 55, 255);">proxy_pass</span> http://<span style="color: rgb(255, 64, 255);">myapp-site</span>;</div><div>            <span style="color: rgb(148, 55, 255);">proxy_redirect  </span>        off;</div><div>          <span style="color: rgb(146, 146, 146);">  # KFH End of the modification;</span></div><div>        }</div><div><br /></div><div><b><font style="font-size: 24px;">Modifying the Pyramid Project’s “development.ini” for the pserve </font></b></div><div><span style="color: rgb(146, 146, 146);"># This will work for the “production.ini” as well.</span></div><div><span style="color: rgb(146, 146, 146);"># Again the m</span><span style="color: rgb(146, 146, 146);">odified or added lines are shown only!</span></div><div><font color="#929292"># To test this you should follow my notes on “Pyramid Framework”.</font></div><div><hr /><div><span style="color: rgb(146, 146, 146);"># KFH: &lt;= [app:main]</span></div></div><div><span style="color: rgb(146, 146, 146);"># KFH Mod:</span></div><div><b>[app:<font color="#ff40ff">KFH_Alchemy</font>]</b></div><div><font color="#929292">...</font></div><div><span style="color: rgb(146, 146, 146);">#KFH: &lt;=pyramid.reload_templates = true</span></div><div><span style="color: rgb(146, 146, 146);">#KFH Mod:</span></div><div><b>pyramid.reload_templates</b> = <font color="#ff2f92">false</font></div><div><br style="color: rgb(146, 146, 146);" /></div><div><span style="color: rgb(146, 146, 146);"># KFH: &lt;=   pyramid_debugtoolbar</span></div><div><br /></div><div><span style="color: rgb(146, 146, 146);">#---------- KFH Pipeline Configuration ----------</span></div><div><b>[filter:paste_prefix]</b></div><div><font color="#0433ff">use </font>= <font color="#941100">egg:PasteDeploy#prefix</font></div><div><br /></div><div><b>[pipeline:main]</b></div><div><font color="#008f00">pipeline</font> =</div><div>    paste_prefix</div><div>    <font color="#ff40ff">KFH_Alchemy</font></div><div><span style="color: rgb(146, 146, 146);"># --- End of KFH Pipline --</span></div><div><font color="#929292">...</font></div><div><b>[server:main]</b></div><div><span style="color: rgb(146, 146, 146);"># KFH: The server will run on 127.0.0.1 with port 8585</span></div><div><b>listen</b> = <font color="#008f00">127.0.0.1</font>:<font color="#009193">8585</font><br /></div><div>...</div><div><br /></div><div><br /></div><div><br /></div><div><br /></div><div> </div><div><br /></div></en-note>